# Telegram--OpenAI-ChatGPT-DALL-E-

## Описание

Этот код представляет собой Telegram-бота, который интегрируется с API OpenAI для выполнения запросов к ChatGPT и DALL-E. Бот принимает текстовые запросы от пользователей для генерации ответов с помощью ChatGPT, а также может генерировать изображения через DALL-E. Он поддерживает голосовые сообщения (при добавлении соответствующего кода) и сохраняет историю общения с каждым пользователем.

## Используемые библиотеки


openai: Библиотека для взаимодействия с API OpenAI.


telebot: Библиотека для создания Telegram-ботов.


uuid: Для генерации уникальных имен файлов.


os: Для работы с файловой системой (создание и удаление файлов).


pydub (закомментировано): Используется для конвертации аудиофайлов, если будет добавлена обработка голосовых сообщений.

## Структура кода


### Чтение токенов:


   - Токены для бота и OpenAI API загружаются из файлов:


   - token_bot: Токен Telegram-бота.


   - token_gpt: Токен OpenAI для доступа к ChatGPT и DALL-E.

## Обработчики команд


1. send_welcome(message)


2. Отправляет приветственное сообщение с информацией о возможных командах при получении /start или /help.


## Обработчики команд
1. send_welcome(message)
Отправляет приветственное сообщение с информацией о возможных командах при получении /start или /help.


2. send_image(message)
Отвечает на команду /image:

   - Удаляет из текста команду /image.


   - Использует OpenAI API для создания изображения через DALL-E на основе запроса пользователя.


   - Отправляет сгенерированное изображение пользователю.


3. clear_history(message)
Очищает историю общения с пользователем при вызове команды /clear. История запросов и ответов ChatGPT удаляется.

## Обработка голосовых сообщений (закомментировано)


### 4. voice_processing(message) (закомментировано)


   - Принимает голосовые сообщения, скачивает их, конвертирует из формата OGG в MP3 (используя pydub), и отправляет на обработку в OpenAI (модель Whisper для транскрипции).
   - Текст, полученный после транскрипции, отправляется в ChatGPT для генерации ответа, который затем возвращается пользователю.


## Обработка текстовых сообщений


### 5. send_answer(message)

 Основная функция для обработки текстовых сообщений от пользователя:

   - Запоминает все сообщения пользователя в словаре user_messages, где ключом является идентификатор пользователя.
   - Отправляет запрос к ChatGPT через OpenAI API и возвращает ответ пользователю.
   - История сообщений сохраняется для каждого пользователя, что позволяет боту вести контекстуальные диалоги.

## Основной цикл


   - bot.polling(): Запускает бота в режиме постоянного ожидания новых сообщений.

 
## Порядок работы бота


Пользователь может отправить команду /start или /help, чтобы получить приветственное сообщение с инструкциями.


Введя текстовое сообщение, пользователь обращается к ChatGPT. Бот сохраняет диалог с каждым пользователем, что позволяет поддерживать контекст в диалоге.


Пользователь может использовать команду /image, чтобы сгенерировать изображение через DALL-E, введя описание.


В любой момент пользователь может очистить историю запросов командой /clear.


При добавлении поддержки голосовых сообщений, бот сможет обрабатывать их с помощью Whisper и отвечать на транскрибированный текст через ChatGPT.


## Ошибки и исключения


### Для каждой функции предусмотрен механизм обработки ошибок:


В случае ошибки при генерации изображения или ответов бот отправляет сообщение: "Не получилось обработать запрос, попробуйте позже".


## Требования


### Установленные библиотеки:
   - openai
   - pyTelegramBotAPI (telebot)
   - pydub (если требуется поддержка голосовых сообщений)
